clear; yalmip('clear');
tic

R=0.5;
toff=1;
p=0.5;
k=1/p;
v0=1;
delta=0.1;
sigma=0.01;


MomList=sdpvar(18,1); 
%[b1, b2, b1v1, b2v1, b1v2, b2v2, b1v3, b2v3]

b1=MomList(1); b2=MomList(2);
b1v1=MomList(3); b2v1=MomList(4);
b1v2=MomList(5); b2v2=MomList(6);
b1v3=MomList(7); b2v3=MomList(8);
b1v4=MomList(9); b2v4=MomList(10);
b1v5=MomList(11); b2v5=MomList(12);
b1v6=MomList(13); b2v6=MomList(14);
b1v7=MomList(15); b2v7=MomList(16);
b1v8=MomList(17); b2v8=MomList(18);

b3=1-b1-b2;


matb1e=[b1, b1v1, b1v2, b1v3, b1v4;...
    b1v1, b1v2, b1v3,b1v4,b1v5;...
    b1v2, b1v3, b1v4,b1v5,b1v6;...
    b1v3, b1v4,b1v5,b1v6,b1v7;...
    b1v4,b1v5,b1v6,b1v7,b1v8];
matb1o=[b1v1, b1v2, b1v3, b1v4;...
    b1v2, b1v3, b1v4, b1v5;...
    b1v3, b1v4, b1v5, b1v6;...
    b1v4, b1v5, b1v6, b1v7];
matb2e=[b2, b2v1, b2v2, b2v3,b2v4;...
    b2v1, b2v2, b2v3,b2v4,b2v5;...
    b2v2, b2v3, b2v4,b2v5,b2v6;...
    b2v3, b2v4,b2v5,b2v6,b2v7;...
    b2v4,b2v5,b2v6,b2v7,b2v8];
matb2o=[b2v1, b2v2, b2v3, b2v4;...
    b2v2, b2v3, b2v4, b2v5;...
    b2v3, b2v4, b2v5, b2v6;...
    b2v4, b2v5, b2v6, b2v7];

 F = [(1/toff)*b3-(p/R+1/(k*R))*b1v1==0,...
    (p/R)*b1v1-1/(k*R)*b2v1==0,...
    (log(2)/R)*b1v1 + delta*b1+(v0/toff)*b3-(p/R+1/(k*R))*b1v2==0,...
    (1/R)*b2+0.5*(p/R)*b1v2-(0.5*p/R+1/(k*R))*b2v2==0,...
    (2*log(2)/R)*b1v2 + 2*delta*b1v1+(v0^2/toff)*b3-(p/R+1/(k*R))*b1v3==0,...
    (2/R)*b2v1+sigma^2*b2v2+0.25*(p/R)*b1v3-(0.75*p/R+1/(k*R))*b2v3==0,...
    (3*log(2)/R)*b1v3 + 3*delta*b1v2+(v0^3/toff)*b3-(p/R+1/(k*R))*b1v4==0,...
    (3/R)*b2v2+3*sigma^2*b2v3+0.125*(p/R)*b1v4-((7/8)*p/R+1/(k*R))*b2v4==0,...
    (4*log(2)/R)*b1v4 + 4*delta*b1v3+(v0^4/toff)*b3-(p/R+1/(k*R))*b1v5==0,...
    (4/R)*b2v3+6*sigma^2*b2v4+p/(16*R)*b1v5-((15/16)*p/R+1/(k*R))*b2v5==0,...
    (5*log(2)/R)*b1v5 + 5*delta*b1v4+(v0^5/toff)*b3-(p/R+1/(k*R))*b1v6==0,...
    (5/R)*b2v4+10*sigma^2*b2v5+p/(32*R)*b1v6-((31/32)*p/R+1/(k*R))*b2v6==0,...
    (6*log(2)/R)*b1v6 + 6*delta*b1v5+(v0^6/toff)*b3-(p/R+1/(k*R))*b1v7==0,...
    (6/R)*b2v5+15*sigma^2*b2v6+p/(64*R)*b1v7-((63/64)*p/R+1/(k*R))*b2v7==0,...
    (7*log(2)/R)*b1v7 + 7*delta*b1v6+(v0^7/toff)*b3-(p/R+1/(k*R))*b1v8==0,...
    (7/R)*b2v6+21*sigma^2*b2v7+p/(128*R)*b1v8-((127/128)*p/R+1/(k*R))*b2v8==0,...
    matb1e>=0,matb1o>=0,matb2e>=0,matb2o>=0];
opts = sdpsettings('solver','sdpa-gmp');
obj = MomList(2);


MinSol = optimize(F,obj,opts);
MinVal = value(obj)

MaxSol = optimize(F,-obj,opts);
MaxVal = value(obj)
toc